from pyformlang.fst import FST

class HimalayaFST:
    def __init__(self):
        self.fst = FST()
        self.build_fst()

    def build_fst(self):
        self.fst.add_transitions([
            ('q0', 'A', 'q1', ['C']),
            ('q1', 'V', 'q2', ['R']),
            ('q2', 'A', 'q3', ['E']),
            ('q3', 'L', 'q4', ['V']),
            ('q4', 'A', 'q5', ['A']),
            ('q5', 'N', 'q6', ['S']),
            ('q6', 'C', 'q7', ['S']),
            ('q7', 'H', 'q8', ['E']),
            ('q8', 'E', 'q9', ['S']),
            ('q9', 'S', 'q10', ['']),
            ('q0', 'C', 'q1', ['A']),
            ('q1', 'R', 'q2', ['V']),
            ('q2', 'E', 'q3', ['A']),
            ('q3', 'V', 'q4', ['L']),
            ('q4', 'A', 'q5', ['A']),
            ('q5', 'S', 'q6', ['N']),
            ('q6', 'S', 'q7', ['C']),
            ('q7', 'E', 'q8', ['H']),
            ('q8', 'S', 'q9', ['E']),
            ('q9', 'epsilon', 'q10', ['S']),
            ('q0', 'W', 'q11', ['F']),
            ('q11', 'I', 'q12', ['R']),
            ('q12', 'N', 'q13', ['E']),
            ('q13', 'D', 'q14', ['E']),
            ('q14', 'Y', 'q15', ['Z']),
            ('q15', 'epsilon', 'q10', ['E']),
            ('q0', 'F', 'q11', ['W']),
            ('q11', 'R', 'q12', ['I']),
            ('q12', 'E', 'q13', ['N']),
            ('q13', 'E', 'q14', ['D']),
            ('q14', 'Z', 'q15', ['Y']),
            ('q15', 'E', 'q10', ['']),
            ('q0', 'B', 'q16', ['L']),
            ('q16', 'H', 'q17', ['E']),
            ('q17', 'U', 'q18', ['P']),
            ('q18', 'T', 'q19', ['C']),
            ('q19', 'I', 'q20', ['H']),
            ('q20', 'A', 'q10', ['A']),
            ('q0', 'L', 'q16', ['B']),
            ('q16', 'E', 'q17', ['H']),
            ('q17', 'P', 'q18', ['U']),
            ('q18', 'C', 'q19', ['T']),
            ('q19', 'H', 'q20', ['I']),
            ('q20', 'A', 'q10', ['A']),
            ('q0', 'D', 'q21', ['A']),
            ('q21', 'E', 'q22', ['C']),
            ('q22', 'C', 'q23', ['T']),
            ('q23', 'I', 'q24', ['I']),
            ('q24', 'S', 'q25', ['O']),
            ('q25', 'I', 'q26', ['N']),
            ('q26', 'O', 'q27', ['S']),
            ('q27', 'N', 'q28', ['']),
            ('q28', 'S', 'q10', ['']),
            ('q0', 'A', 'q21', ['D']),
            ('q21', 'C', 'q22', ['E']),
            ('q22', 'T', 'q23', ['C']),
            ('q23', 'I', 'q24', ['I']),
            ('q24', 'O', 'q25', ['S']),
            ('q25', 'N', 'q26', ['I']),
            ('q26', 'S', 'q27', ['O']),
            ('q27', 'epsilon', 'q28', ['N']),
            ('q28', 'epsilon', 'q10', ['S']),
        ])
        self.fst.add_start_state('q0')
        self.fst.add_final_state('q10')

    def transform(self, input_text):
        result = list(map(lambda x: "".join(x), list(self.fst.translate(input_text))))
        return result